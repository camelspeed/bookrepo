language:
- python
python:
- 2.7
install:
- pip install -r requirements.txt
- pip install coveralls
script:
- python dewey_tests.py
- coverage run dewey_tests.py
before_deploy:
- zip -r latest *
- mkdir -p dpl_cd_upload
- mv latest.zip dpl_cd_upload/latest.zip
deploy:
- provider: s3
  access_key_id: &1
    secure: vc0rucAL8ho36UH8laAb9x1nttciso/Ar7bJbIihq5SNSCA/haX9zWlTUr92rU79OMUHOSA0SgQdBcOKc9uW9rqfWn2GJmFK/DtrOg+h/Rw0oGyY+EnN3p3WoOmYOxU4MS3RK+8om3XT4DHRpo8zcz93bp3ABfBEcDX/6//WEE6N0h/3sj7VIe5LdRDZ+CDnNzakUyWx9cK6qM5UACGa5UFKxuD1r30LXxw9qRTDa7ats85FyWej7xTzyrTPgrzFMJIUpvNekuDYD3HayAIeFyq/kvkGOfoWd2FiuzWgOJQvp0OQ2e/x0sdTGzXF9HAOsiTzFxapLUvLDNgh7eTIeY/x1zz3h9vsCclh9oeD6iD8ZWjiWFJA6X2iyk6HHkLRIBr87sDvJl4kkqQZ/IVZi5+uoRmzgkzCzMe1sKRkLLAh1wpdo46OQUqR5tQeuK4YXHVmbMN5aHjBhazNjWy0bxyBTnX7ZefmLerghDlD+5JeRAQ+8ROfF4CGmf4K3yWqwmLtZIEc5HsBh+UFUCigytUXyJwBAfj0PwUv7eudEnWoNYDxpia1snhQi23VTETptLjG1glLumF0nLDqBD7sgkgCNepFsgXNqnTkkJz3ckxzNDha7VVtIKX84bXp1/o3ppu41meYe4uRgfzE1T0/zWnhWw859WwDD0ijceMWMUk=
  secret_access_key: &2
    secure: 3SNbIAVpiseBQEU5BiFpwV9G2K9ZFORC+V7mift1Y+wRiunCXrWuaRb7yr+hHfxf/wgEMir46geKV7HCmBu4svvdgRKENDmj7bv0mvUlLN3jvlF+BDzHNTFcCW0ZiTObf0LacEGN4W+63i1VqPBYNRy0a3AD62HRAjzbNW8JkMSPVYjGC/vTGKtab3ZyBS2S4MxTJgWbkc50TZ6g2UhkLxE5Tl/4QvACkF+uIEi0FCtuFOpcD68x3KhbQDPYtOSszJ+k2ikTTJeW2mQsleF+b6RK3wWvPKxQZLYsOmfVTg0jn6B2SGs5+iWRFCDqmF7jmgy3x1ImsV1DLQizBrfTlmxuy3p5RV7E8dVEUVB2ympWvAVRTMCTFeAaHAFlMO7ip2oA8frz8snm5FyNLc13E+sj+LQ/AaTwz3IbAiA40GrFQC7rmaG5JfVnotSoPlkeR4xhaZ6KYIaXlnvPlVSBJAtzWwPbll5/7wNi37apekubHpBr5n01SEaMX1W+T3nbvgnO+bJ1/ElCtEvJRca7udQ7vlrTlouUhk+V5Ot8KTJGSRBx28qKn4vD3elsdmPsTkPWQ8Cj4mw94+X91s8XzuzcDRVCzS1UFTN3hCN2dNZYA5+O3TWYJF0SPMUXppKiRJCp8+E9+beF1OJo0/bzJ4imeqQ9+N6dv2t1kttA+9E=
  local_dir: dpl_cd_upload
  skip_cleanup: true
  on: &3
    repo: camelspeed/dewey
  bucket: camelspeed-dewey
  region: us-west-2
- provider: codedeploy
  access_key_id: *1
  secret_access_key: *2
  bucket: camelspeed-dewey
  key: latest.zip
  bundle_type: zip
  application: camelspeed-dewey-webapp
  deployment_group: camelspeed-dewey-webapps
  region: us-east-1
  on: *3
after_success:
- coveralls

